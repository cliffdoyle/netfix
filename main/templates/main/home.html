{% extends 'main/base.html' %}

{% block title %}
    NetFix
{% endblock %}

{% block content %}
    <div style="margin-top: 50px;">
        <p class="site_title">NetFix</p>
        <img class="home_logo" src="static/css/logo.png" alt="logo">

        <!-- Link to View All Services (Most Recent First) -->
        <div class="home-links">
            <a href="{% url 'services:service_list' %}" class="service-link">
                View All Services (Most Recent First)
            </a>
        </div>

        <!-- Link to Most Requested Services -->
        <div class="most-requested-section">
            <h3>Check Out the Most Requested Services!</h3>
            <p>Explore the top 10 most requested services by users.</p>
            <a href="{% url 'services:most_requested_services' %}" class="btn btn-primary">View Most Requested Services</a>
        </div>

        <!-- Dropdown for category selection -->
        <form method="get" class="filter-form">
            <label for="field">Filter by Category:</label>
            <select name="field" id="field" onchange="this.form.submit()">
                <option value="">All Categories</option>
                {% for field in fields %}
                    <option value="{{ field }}" {% if field == selected_field %}selected{% endif %}>{{ field }}</option>
                {% endfor %}
            </select>
        </form>

        {% if selected_field %}
            <h2>Services in {{ selected_field }}</h2>
            <!-- Display services for selected category -->
            <div class="service-list">
                {% if services %}
                    {% for service in services %}
                        <div class="service-item">
                            <h3>{{ service.name }}</h3>
                            <p>{{ service.description|truncatewords:20 }}</p>
                            <p><strong>Price/hour:</strong> ${{ service.price_hour }}</p>
                            <p><strong>Rating:</strong> {{ service.rating }}/5</p>
                            <p><strong>Company:</strong> {{ service.company.user.username }}</p>
                            <a href="{% url 'services:service_detail' service.id %}">View Details</a>
                        </div>
                    {% endfor %}
                {% else %}
                    <p>No services available in this category yet.</p>
                {% endif %}
            </div>
        {% endif %}
    </div>
{% endblock %}
